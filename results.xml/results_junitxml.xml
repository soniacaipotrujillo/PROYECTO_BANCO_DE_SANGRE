<?xml version="1.0" ?>
<testsuites disabled="0" errors="0" failures="8" tests="16" time="0.0">
	<testsuite disabled="0" errors="0" failures="8" name="terraform scan" skipped="0" tests="16" time="0">
		<properties>
			<property name="directory" value="['./IAC']"/>
			<property name="add_check" value="False"/>
			<property name="list" value="False"/>
			<property name="output" value="['junitxml']"/>
			<property name="output_file_path" value="results.xml"/>
			<property name="output_bc_ids" value="False"/>
			<property name="include_all_checkov_policies" value="True"/>
			<property name="quiet" value="False"/>
			<property name="compact" value="False"/>
			<property name="framework" value="['all']"/>
			<property name="skip_framework" value="[]"/>
			<property name="run_all_external_checks" value="False"/>
			<property name="soft_fail" value="False"/>
			<property name="skip_results_upload" value="False"/>
			<property name="repo_id" value="cli_repo/IAC"/>
			<property name="branch" value="master"/>
			<property name="skip_download" value="False"/>
			<property name="use_enforcement_rules" value="False"/>
			<property name="external_modules_download_path" value=".external_modules"/>
			<property name="evaluate_variables" value="True"/>
			<property name="no_cert_verify" value="False"/>
			<property name="create_baseline" value="False"/>
			<property name="output_baseline_as_skipped" value="False"/>
			<property name="secrets_scan_file_type" value="[]"/>
			<property name="enable_secret_scan_all_files" value="False"/>
			<property name="block_list_secret_scan" value="[]"/>
			<property name="summary_position" value="top"/>
			<property name="skip_resources_without_violations" value="False"/>
			<property name="deep_analysis" value="False"/>
			<property name="no_fail_on_crash" value="False"/>
			<property name="mask" value="defaultdict(&lt;class 'set'&gt;, {})"/>
			<property name="scan_secrets_history" value="False"/>
			<property name="secrets_history_timeout" value="12h"/>
			<property name="custom_tool_name" value="Checkov"/>
		</properties>
		<testcase name="[NONE][CKV_AWS_25] Ensure no security groups allow ingress from 0.0.0.0:0 to port 3389" classname="\main.tf.aws_security_group.banco_sangre_sg" file="\main.tf"/>
		<testcase name="[NONE][CKV_AWS_260] Ensure no security groups allow ingress from 0.0.0.0:0 to port 80" classname="\main.tf.aws_security_group.banco_sangre_sg" file="\main.tf"/>
		<testcase name="[NONE][CKV_AWS_277] Ensure no security groups allow ingress from 0.0.0.0:0 to port -1" classname="\main.tf.aws_security_group.banco_sangre_sg" file="\main.tf"/>
		<testcase name="[NONE][CKV_AWS_46] Ensure no hard-coded secrets exist in EC2 user data" classname="\main.tf.aws_instance.banco_sangre_ec2" file="\main.tf"/>
		<testcase name="[NONE][CKV_AWS_88] EC2 instance should not have public IP." classname="\main.tf.aws_instance.banco_sangre_ec2" file="\main.tf"/>
		<testcase name="[NONE][CKV_AWS_386] Reduce potential for WhoAMI cloud image name confusion attack" classname="\main.tf.aws_ami.ubuntu" file="\main.tf"/>
		<testcase name="[NONE][CKV_AWS_41] Ensure no hard coded AWS access key and secret key exists in provider" classname="\provider.tf.aws.default" file="\provider.tf"/>
		<testcase name="[NONE][CKV2_AWS_5] Ensure that Security Groups are attached to another resource" classname="\main.tf.aws_security_group.banco_sangre_sg" file="\main.tf"/>
		<testcase name="[NONE][CKV_AWS_23] Ensure every security group and rule has a description" classname="\main.tf.aws_security_group.banco_sangre_sg" file="\main.tf">
			<failure type="failure" message="Ensure every security group and rule has a description">
Resource: aws_security_group.banco_sangre_sg
File: \main.tf: 23-53
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31

		23 | resource &quot;aws_security_group&quot; &quot;banco_sangre_sg&quot; {
		24 |   name        = &quot;${var.project_name}-sg&quot;
		25 |   description = &quot;Security group para la app Banco de Sangre&quot;
		26 |   vpc_id      = null # usará la VPC por defecto
		27 | 
		28 |   # Puerto 5000 para Flask
		29 |   ingress {
		30 |     description = &quot;Flask dev port 5000&quot;
		31 |     from_port   = 5000
		32 |     to_port     = 5000
		33 |     protocol    = &quot;tcp&quot;
		34 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		35 |   }
		36 | 
		37 |   # SSH para conectarte a la instancia
		38 |   ingress {
		39 |     description = &quot;SSH&quot;
		40 |     from_port   = 22
		41 |     to_port     = 22
		42 |     protocol    = &quot;tcp&quot;
		43 |     cidr_blocks = [&quot;0.0.0.0/0&quot;] # Para producción, restringe esto a tu IP
		44 |   }
		45 | 
		46 |   # Salida a internet
		47 |   egress {
		48 |     from_port   = 0
		49 |     to_port     = 0
		50 |     protocol    = &quot;-1&quot;
		51 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		52 |   }
		53 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_382] Ensure no security groups allow egress from 0.0.0.0:0 to port -1" classname="\main.tf.aws_security_group.banco_sangre_sg" file="\main.tf">
			<failure type="failure" message="Ensure no security groups allow egress from 0.0.0.0:0 to port -1">
Resource: aws_security_group.banco_sangre_sg
File: \main.tf: 23-53
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382

		23 | resource &quot;aws_security_group&quot; &quot;banco_sangre_sg&quot; {
		24 |   name        = &quot;${var.project_name}-sg&quot;
		25 |   description = &quot;Security group para la app Banco de Sangre&quot;
		26 |   vpc_id      = null # usará la VPC por defecto
		27 | 
		28 |   # Puerto 5000 para Flask
		29 |   ingress {
		30 |     description = &quot;Flask dev port 5000&quot;
		31 |     from_port   = 5000
		32 |     to_port     = 5000
		33 |     protocol    = &quot;tcp&quot;
		34 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		35 |   }
		36 | 
		37 |   # SSH para conectarte a la instancia
		38 |   ingress {
		39 |     description = &quot;SSH&quot;
		40 |     from_port   = 22
		41 |     to_port     = 22
		42 |     protocol    = &quot;tcp&quot;
		43 |     cidr_blocks = [&quot;0.0.0.0/0&quot;] # Para producción, restringe esto a tu IP
		44 |   }
		45 | 
		46 |   # Salida a internet
		47 |   egress {
		48 |     from_port   = 0
		49 |     to_port     = 0
		50 |     protocol    = &quot;-1&quot;
		51 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		52 |   }
		53 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_24] Ensure no security groups allow ingress from 0.0.0.0:0 to port 22" classname="\main.tf.aws_security_group.banco_sangre_sg" file="\main.tf">
			<failure type="failure" message="Ensure no security groups allow ingress from 0.0.0.0:0 to port 22">
Resource: aws_security_group.banco_sangre_sg
File: \main.tf: 23-53
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security

		23 | resource &quot;aws_security_group&quot; &quot;banco_sangre_sg&quot; {
		24 |   name        = &quot;${var.project_name}-sg&quot;
		25 |   description = &quot;Security group para la app Banco de Sangre&quot;
		26 |   vpc_id      = null # usará la VPC por defecto
		27 | 
		28 |   # Puerto 5000 para Flask
		29 |   ingress {
		30 |     description = &quot;Flask dev port 5000&quot;
		31 |     from_port   = 5000
		32 |     to_port     = 5000
		33 |     protocol    = &quot;tcp&quot;
		34 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		35 |   }
		36 | 
		37 |   # SSH para conectarte a la instancia
		38 |   ingress {
		39 |     description = &quot;SSH&quot;
		40 |     from_port   = 22
		41 |     to_port     = 22
		42 |     protocol    = &quot;tcp&quot;
		43 |     cidr_blocks = [&quot;0.0.0.0/0&quot;] # Para producción, restringe esto a tu IP
		44 |   }
		45 | 
		46 |   # Salida a internet
		47 |   egress {
		48 |     from_port   = 0
		49 |     to_port     = 0
		50 |     protocol    = &quot;-1&quot;
		51 |     cidr_blocks = [&quot;0.0.0.0/0&quot;]
		52 |   }
		53 | }
</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_126] Ensure that detailed monitoring is enabled for EC2 instances" classname="\main.tf.aws_instance.banco_sangre_ec2" file="\main.tf">
			<failure type="failure" message="Ensure that detailed monitoring is enabled for EC2 instances">
Resource: aws_instance.banco_sangre_ec2
File: \main.tf: 58-110
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_135] Ensure that EC2 is EBS optimized" classname="\main.tf.aws_instance.banco_sangre_ec2" file="\main.tf">
			<failure type="failure" message="Ensure that EC2 is EBS optimized">
Resource: aws_instance.banco_sangre_ec2
File: \main.tf: 58-110
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_79] Ensure Instance Metadata Service Version 1 is not enabled" classname="\main.tf.aws_instance.banco_sangre_ec2" file="\main.tf">
			<failure type="failure" message="Ensure Instance Metadata Service Version 1 is not enabled">
Resource: aws_instance.banco_sangre_ec2
File: \main.tf: 58-110
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV_AWS_8] Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted" classname="\main.tf.aws_instance.banco_sangre_ec2" file="\main.tf">
			<failure type="failure" message="Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted">
Resource: aws_instance.banco_sangre_ec2
File: \main.tf: 58-110
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
		<testcase name="[NONE][CKV2_AWS_41] Ensure an IAM role is attached to EC2 instance" classname="\main.tf.aws_instance.banco_sangre_ec2" file="\main.tf">
			<failure type="failure" message="Ensure an IAM role is attached to EC2 instance">
Resource: aws_instance.banco_sangre_ec2
File: \main.tf: 58-110
Guideline: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance

		Code lines for this resource are too many. Please use IDE of your choice to review the file.</failure>
		</testcase>
	</testsuite>
</testsuites>
